{{block "index" .}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Index Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.7/dist/htmx.min.js" integrity="sha384-ZBXiYtYQ6hJ2Y0ZNoYuI+Nq5MqWBr+chMrS/RkXpNzQCApHEhOt2aY8EJgqwHLkJ" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container mt-5">
        <header class="text-center mb-4">
            <h1 class="display-4">{{.Title}}</h1>
        </header>
        
        {{template "form" .}}
        <hr>
        {{template "finances-list" .}}
        
        <footer class="pt-3 mt-4 text-muted border-top text-center">
            <p>&copy; 2025 My Website</p>
        </footer>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>
</html>
{{end}}

{{block "form" .}}
<form hx-swap="beforeend" hx-target="#finances" hx-post="/render/finances">
    <div class="form-group">
        <label>Name</label>
        <input type="text" class="form-control" placeholder="Enter name" name="name">
    </div>
    <div class="form-group">
        <label>Amount</label>
        <input type="number" step="0.01" class="form-control" placeholder="Enter amount" name="amount">
    </div>
    <div class="form-group">
        <label>Category</label>
        <select name="category" class="form-select">
            <option selected>Fixed Cost</option>
            <option>Comfort</option>
            <option>Goals</option>
            <option>Pleasures</option>
            <option>Financial Freedom</option>
            <option>Knowledge</option>
        </select>
    </div>
    <div class="form-group">
        <label>Created At</label>
        <input type="datetime-local" class="form-control" name="created_at">
    </div>
    <button type="submit" class="btn btn-primary">Add</button>
</form>
{{end}}

{{block "finances-list" .}}
<ul class="list-group" id="finances">
    {{range .Finances}}
        {{template "finance-list-item" .}}
    {{end}}
</ul>
{{end}}

{{block "finance-list-item" .}}
<li class="list-group-item d-flex justify-content-between align-items-center">
    <div>
        <span class="fw-bold">{{.Name}}</span>
        <small class="text-muted d-block">{{.Category}}</small>
    </div>
    <div>
        {{.CreatedAt}}
    </div>
    <div class="d-flex align-items-center">
        <span class="me-3">R$ {{.Amount}}</span>
        <div>
            <button hx-get="render/finances/edit/{{.Id}}" hx-target="closest li" hx-swap="outerHTML" class="btn btn-primary btn-sm">Edit</button>
            <button hx-delete="/finances/{{.Id}}" hx-target="closest li" hx-swap="outerHTML" class="btn btn-danger btn-sm">Delete</button>
        </div>
    </div>
</li>
{{end}}

{{block "edit-finance-list-item" .}}
<li class="list-group-item">
    <div class="d-flex align-items-center">
        <input type="text" name="name" value="{{.Name}}" class="form-control me-2">
        <select name="category" class="form-select">
            <option {{if eq .Category "Fixed Cost"}} selected {{end}} >Fixed Cost</option>
            <option {{if eq .Category "Comfort"}} selected {{end}} >Comfort</option>
            <option {{if eq .Category "Goals"}} selected {{end}} >Goals</option>
            <option {{if eq .Category "Pleasures"}} selected {{end}} >Pleasures</option>
            <option {{if eq .Category "Financial Freedom"}} selected {{end}} >Financial Freedom</option>
            <option {{if eq .Category "Knowledge"}} selected {{end}} >Knowledge</option>
        </select>
        <input type="number" step="0.01" name="amount" value="{{.Amount}}" class="form-control me-3">
        <input type="datetime-local" name="created_at" value="{{.CreatedAt}}" class="form-control me-3">
        <div>
            <button hx-patch="render/finances/{{.Id}}" hx-include="closest li" hx-target="closest li" hx-swap="outerHTML" class="btn btn-success btn-sm">Save</button>
            <button hx-get="render/finances/{{.Id}}" hx-target="closest li" hx-swap="outerHTML" class="btn btn-secondary btn-sm">Cancel</button>
        </div>
    </div>
</li>
{{end}}